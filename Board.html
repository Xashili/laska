<!DOCTYPE HTML>
<html><head><meta charset="UTF-8"><title>Board</title><script type="text/javascript" src="/usr/share/Elm-0.10.1/elm-runtime.js"></script><script type="text/javascript">Elm.Board = Elm.Board || {};
Elm.Board.make = function (_elm) {
   _elm.Board = _elm.Board || {};
   if (_elm.Board.values)
   return _elm.Board.values;
   var N = Elm.Native,
   _N = N.Utils.make(_elm),
   _L = N.List.make(_elm),
   _E = N.Error.make(_elm),
   _J = N.JavaScript.make(_elm),
   $moduleName = "Board";
   var Text = Elm.Text.make(_elm);
   var Text = Elm.Text.make(_elm);
   var Basics = Elm.Basics.make(_elm);
   var Signal = Elm.Signal.make(_elm);
   var List = Elm.List.make(_elm);
   var Maybe = Elm.Maybe.make(_elm);
   var Time = Elm.Time.make(_elm);
   var Prelude = Elm.Prelude.make(_elm);
   var Graphics = Graphics || {};
   Graphics.Element = Elm.Graphics.Element.make(_elm);
   var Color = Elm.Color.make(_elm);
   var Graphics = Graphics || {};
   Graphics.Collage = Elm.Graphics.Collage.make(_elm);
   var Dict = Elm.Dict.make(_elm);
   var Types = Elm.Types.make(_elm);
   var Helper = Elm.Helper.make(_elm);
   var _op = {};
   var moved = F3(function (board,
   pnt,
   to) {
      return function () {
         var _v0 = A2(Dict.lookup,
         pnt,
         board);
         switch (_v0.ctor)
         {case "Just":
            return A2(Dict.insert,
              to,
              _v0._0)(A2(Dict.remove,
              pnt,
              board));
            case "Nothing": return board;}
         _E.Case($moduleName,
         "between lines 57 and 59");
      }();
   });
   var makeGenerals = function (board) {
      return A2(List.foldr,
      F2(function (_v14,b) {
         return function () {
            switch (_v14.ctor)
            {case "_Tuple2":
               return A2(Dict.insert,
                 _v14._0,
                 _v14._1)(A2(Dict.remove,
                 _v14._0,
                 b));}
            _E.Case($moduleName,
            "on line 84, column 11 to 54");
         }();
      }),
      board)(List.map(function (_v6) {
         return function () {
            switch (_v6.ctor)
            {case "_Tuple2":
               switch (_v6._1.ctor)
                 {case "::":
                    switch (_v6._1._0.ctor)
                      {case "_Tuple2":
                         return {ctor: "_Tuple2"
                                ,_0: _v6._0
                                ,_1: {ctor: "::"
                                     ,_0: {ctor: "_Tuple2"
                                          ,_0: _v6._1._0._0
                                          ,_1: Types.General}
                                     ,_1: _v6._1._1}};}
                      break;}
                 break;}
            _E.Case($moduleName,
            "on line 82, column 35 to 59");
         }();
      })(List.filter(function (_v2) {
         return function () {
            switch (_v2.ctor)
            {case "_Tuple2":
               return _N.eq(A2(Types.owner,
                 board,
                 _v2._0),
                 Maybe.Just(Types.Own)) && A2(Helper.elem,
                 _v2._0,
                 _J.toList([{ctor: "_Tuple2"
                            ,_0: 6
                            ,_1: 0}
                           ,{ctor: "_Tuple2",_0: 6,_1: 2}
                           ,{ctor: "_Tuple2",_0: 6,_1: 4}
                           ,{ctor: "_Tuple2"
                            ,_0: 6
                            ,_1: 6}])) || _N.eq(A2(Types.owner,
                 board,
                 _v2._0),
                 Maybe.Just(Types.Enemy)) && A2(Helper.elem,
                 _v2._0,
                 _J.toList([{ctor: "_Tuple2"
                            ,_0: 0
                            ,_1: 0}
                           ,{ctor: "_Tuple2",_0: 0,_1: 2}
                           ,{ctor: "_Tuple2",_0: 0,_1: 4}
                           ,{ctor: "_Tuple2"
                            ,_0: 0
                            ,_1: 6}]));}
            _E.Case($moduleName,
            "between lines 80 and 81");
         }();
      })(Dict.toList(board))));
   };
   var jumped = F3(function (board,
   from,
   over) {
      return function () {
         var to = A2(Helper.newPlace,
         over,
         from);
         return function () {
            var _v18 = {ctor: "_Tuple2"
                       ,_0: A2(Dict.lookup,from,board)
                       ,_1: A2(Dict.lookup,
                       over,
                       board)};
            switch (_v18.ctor)
            {case "_Tuple2":
               switch (_v18._1.ctor)
                 {case "Nothing": return board;}
                 switch (_v18._0.ctor)
                 {case "Just":
                    switch (_v18._1.ctor)
                      {case "Just":
                         return function (dict) {
                              return _N.cmp(List.length(_v18._1._0),
                              1) > 0 ? A3(Dict.insert,
                              over,
                              List.tail(_v18._1._0),
                              dict) : dict;
                           }(A2(Dict.insert,
                           to,
                           _L.append(_v18._0._0,
                           _J.toList([List.head(_v18._1._0)])))(Dict.remove(over)(A2(Dict.remove,
                           from,
                           board))));}
                      break;
                    case "Nothing": return board;}
                 break;}
            _E.Case($moduleName,
            "between lines 65 and 74");
         }();
      }();
   });
   var directions = F2(function (board,
   pnt) {
      return List.map(Helper.addTuple(pnt))(function () {
         var _v23 = A2(Dict.lookup,
         pnt,
         board);
         switch (_v23.ctor)
         {case "Just":
            switch (_v23._0.ctor)
              {case "::":
                 switch (_v23._0._0.ctor)
                   {case "_Tuple2":
                      switch (_v23._0._0._0.ctor)
                        {case "Enemy":
                           switch (_v23._0._0._1.ctor)
                             {case "Peasant":
                                return _J.toList([{ctor: "_Tuple2"
                                                  ,_0: -1
                                                  ,_1: -1}
                                                 ,{ctor: "_Tuple2"
                                                  ,_0: -1
                                                  ,_1: 1}]);}
                             break;
                           case "Own":
                           switch (_v23._0._0._1.ctor)
                             {case "Peasant":
                                return _J.toList([{ctor: "_Tuple2"
                                                  ,_0: 1
                                                  ,_1: -1}
                                                 ,{ctor: "_Tuple2"
                                                  ,_0: 1
                                                  ,_1: 1}]);}
                             break;}
                        switch (_v23._0._0._1.ctor)
                        {case "General":
                           return _J.toList([{ctor: "_Tuple2"
                                             ,_0: 1
                                             ,_1: -1}
                                            ,{ctor: "_Tuple2",_0: 1,_1: 1}
                                            ,{ctor: "_Tuple2",_0: -1,_1: -1}
                                            ,{ctor: "_Tuple2"
                                             ,_0: -1
                                             ,_1: 1}]);}
                        break;}
                   break;}
              break;
            case "Nothing":
            return _J.toList([]);}
         _E.Case($moduleName,
         "between lines 23 and 27");
      }());
   });
   var boardPoints = function () {
      var points = A2(List.concatMap,
      function (x) {
         return A2(List.map,
         function (y) {
            return {ctor: "_Tuple2"
                   ,_0: x
                   ,_1: y};
         },
         _L.range(0,6));
      },
      _L.range(0,6));
      return A2(List.filter,
      function (_v29) {
         return function () {
            switch (_v29.ctor)
            {case "_Tuple2":
               return Helper.isEven(_v29._0 + _v29._1);}
            _E.Case($moduleName,
            "on line 11, column 24 to 35");
         }();
      },
      points);
   }();
   var onBoard = function (pnt) {
      return A2(Helper.elem,
      pnt,
      boardPoints);
   };
   var canMoveTo = F3(function (board,
   pnt,
   to) {
      return A2(Helper.elem,
      to,
      A2(directions,
      board,
      pnt)) && (onBoard(to) && Basics.not(A2(Dict.member,
      to,
      board)));
   });
   var canJumpTo = F4(function (board,
   over,
   pnt,
   to) {
      return function () {
         var ownPillar = A3(Dict.findWithDefault,
         _J.toList([]),
         pnt,
         board);
         return Basics.not(A2(Helper.elem,
         to,
         over)) && (A2(Helper.elem,
         to,
         A2(directions,
         board,
         pnt)) && (onBoard(to) && (onBoard(A2(Helper.newPlace,
         to,
         pnt)) && (A3(canMoveTo,
         A3(Dict.insert,
         to,
         ownPillar,
         board),
         to,
         A2(Helper.newPlace,
         to,
         pnt)) && function () {
            var _v33 = {ctor: "_Tuple2"
                       ,_0: A2(Types.owner,board,pnt)
                       ,_1: A2(Types.owner,board,to)};
            switch (_v33.ctor)
            {case "_Tuple2":
               switch (_v33._1.ctor)
                 {case "Nothing": return false;}
                 switch (_v33._0.ctor)
                 {case "Just":
                    switch (_v33._0._0.ctor)
                      {case "Enemy":
                         switch (_v33._1.ctor)
                           {case "Just":
                              switch (_v33._1._0.ctor)
                                {case "Own": return true;}
                                break;}
                           break;
                         case "Own":
                         switch (_v33._1.ctor)
                           {case "Just":
                              switch (_v33._1._0.ctor)
                                {case "Enemy": return true;}
                                break;}
                           break;}
                      break;
                    case "Nothing": return false;}
                 break;}
            return false;
         }()))));
      }();
   });
   var canJump = F3(function (board,
   over,
   pnt) {
      return List.any(A3(canJumpTo,
      board,
      over,
      pnt))(A2(directions,board,pnt));
   });
   var canMove = F2(function (board,
   pnt) {
      return List.any(A2(canMoveTo,
      board,
      pnt))(A2(directions,board,pnt));
   });
   var startField = Dict.fromList(_L.append(A2(List.map,
   function (pnt) {
      return {ctor: "_Tuple2"
             ,_0: pnt
             ,_1: _J.toList([{ctor: "_Tuple2"
                             ,_0: Types.Own
                             ,_1: Types.Peasant}])};
   },
   A2(List.take,11,boardPoints)),
   A2(List.map,
   function (pnt) {
      return {ctor: "_Tuple2"
             ,_0: pnt
             ,_1: _J.toList([{ctor: "_Tuple2"
                             ,_0: Types.Enemy
                             ,_1: Types.Peasant}])};
   },
   A2(List.drop,14,boardPoints))));
   _elm.Board.values = {_op: _op
                       ,boardPoints: boardPoints
                       ,onBoard: onBoard
                       ,startField: startField
                       ,directions: directions
                       ,canMoveTo: canMoveTo
                       ,canJumpTo: canJumpTo
                       ,canMove: canMove
                       ,canJump: canJump
                       ,moved: moved
                       ,jumped: jumped
                       ,makeGenerals: makeGenerals};
   return _elm.Board.values;
};Elm.Helper = Elm.Helper || {};
Elm.Helper.make = function (_elm) {
   _elm.Helper = _elm.Helper || {};
   if (_elm.Helper.values)
   return _elm.Helper.values;
   var N = Elm.Native,
   _N = N.Utils.make(_elm),
   _L = N.List.make(_elm),
   _E = N.Error.make(_elm),
   _J = N.JavaScript.make(_elm),
   $moduleName = "Helper";
   var Text = Elm.Text.make(_elm);
   var Text = Elm.Text.make(_elm);
   var Basics = Elm.Basics.make(_elm);
   var Signal = Elm.Signal.make(_elm);
   var List = Elm.List.make(_elm);
   var Maybe = Elm.Maybe.make(_elm);
   var Time = Elm.Time.make(_elm);
   var Prelude = Elm.Prelude.make(_elm);
   var Graphics = Graphics || {};
   Graphics.Element = Elm.Graphics.Element.make(_elm);
   var Color = Elm.Color.make(_elm);
   var Graphics = Graphics || {};
   Graphics.Collage = Elm.Graphics.Collage.make(_elm);
   var _op = {};
   var subTuple = F2(function (_v0,
   _v1) {
      return function () {
         switch (_v1.ctor)
         {case "_Tuple2":
            return function () {
                 switch (_v0.ctor)
                 {case "_Tuple2":
                    return {ctor: "_Tuple2"
                           ,_0: _v0._0 - _v1._0
                           ,_1: _v0._1 - _v1._1};}
                 _E.Case($moduleName,
                 "on line 5, column 25 to 32");
              }();}
         _E.Case($moduleName,
         "on line 5, column 25 to 32");
      }();
   });
   var newPlace = F2(function (_v8,
   _v9) {
      return function () {
         switch (_v9.ctor)
         {case "_Tuple2":
            return function () {
                 switch (_v8.ctor)
                 {case "_Tuple2":
                    return {ctor: "_Tuple2"
                           ,_0: _v8._0 + (_v8._0 - _v9._0)
                           ,_1: _v8._1 + (_v8._1 - _v9._1)};}
                 _E.Case($moduleName,
                 "on line 9, column 25 to 40");
              }();}
         _E.Case($moduleName,
         "on line 9, column 25 to 40");
      }();
   });
   var isEven = function (x) {
      return _N.eq(A2(Basics.mod,
      x,
      2),
      0);
   };
   var find = F2(function (f,a) {
      return function () {
         var filtered = A2(List.filter,
         f,
         a);
         return List.isEmpty(filtered) ? Maybe.Nothing : Maybe.Just(List.head(filtered));
      }();
   });
   var elem = F2(function (x,a) {
      return A2(List.any,
      function (y) {
         return _N.eq(x,y);
      },
      a);
   });
   var addTuple = F2(function (_v16,
   _v17) {
      return function () {
         switch (_v17.ctor)
         {case "_Tuple2":
            return function () {
                 switch (_v16.ctor)
                 {case "_Tuple2":
                    return {ctor: "_Tuple2"
                           ,_0: _v16._0 + _v17._0
                           ,_1: _v16._1 + _v17._1};}
                 _E.Case($moduleName,
                 "on line 4, column 25 to 32");
              }();}
         _E.Case($moduleName,
         "on line 4, column 25 to 32");
      }();
   });
   _elm.Helper.values = {_op: _op
                        ,isEven: isEven
                        ,addTuple: addTuple
                        ,subTuple: subTuple
                        ,elem: elem
                        ,find: find
                        ,newPlace: newPlace};
   return _elm.Helper.values;
};Elm.Types = Elm.Types || {};
Elm.Types.make = function (_elm) {
   _elm.Types = _elm.Types || {};
   if (_elm.Types.values)
   return _elm.Types.values;
   var N = Elm.Native,
   _N = N.Utils.make(_elm),
   _L = N.List.make(_elm),
   _E = N.Error.make(_elm),
   _J = N.JavaScript.make(_elm),
   $moduleName = "Types";
   var Text = Elm.Text.make(_elm);
   var Text = Elm.Text.make(_elm);
   var Basics = Elm.Basics.make(_elm);
   var Signal = Elm.Signal.make(_elm);
   var List = Elm.List.make(_elm);
   var Maybe = Elm.Maybe.make(_elm);
   var Time = Elm.Time.make(_elm);
   var Prelude = Elm.Prelude.make(_elm);
   var Graphics = Graphics || {};
   Graphics.Element = Elm.Graphics.Element.make(_elm);
   var Color = Elm.Color.make(_elm);
   var Graphics = Graphics || {};
   Graphics.Collage = Elm.Graphics.Collage.make(_elm);
   var Dict = Elm.Dict.make(_elm);
   var _op = {};
   var owner = F2(function (board,
   pnt) {
      return function () {
         var _v0 = A2(Dict.lookup,
         pnt,
         board);
         switch (_v0.ctor)
         {case "Just":
            return Maybe.Just(Basics.fst(List.head(_v0._0)));
            case "Nothing":
            return Maybe.Nothing;}
         _E.Case($moduleName,
         "between lines 20 and 22");
      }();
   });
   var Won = function (a) {
      return {ctor: "Won",_0: a};
   };
   var Turn = function (a) {
      return {ctor: "Turn",_0: a};
   };
   var Peasant = {ctor: "Peasant"};
   var Own = {ctor: "Own"};
   var MustMove = {ctor: "MustMove"};
   var MustJump = {ctor: "MustJump"};
   var General = {ctor: "General"};
   var FromMove = function (a) {
      return {ctor: "FromMove"
             ,_0: a};
   };
   var FromJump = F2(function (a,
   b) {
      return {ctor: "FromJump"
             ,_0: a
             ,_1: b};
   });
   var Enemy = {ctor: "Enemy"};
   var other = function (p) {
      return function () {
         switch (p.ctor)
         {case "Enemy": return Own;
            case "Own": return Enemy;}
         _E.Case($moduleName,
         "between lines 25 and 27");
      }();
   };
   _elm.Types.values = {_op: _op
                       ,owner: owner
                       ,other: other
                       ,Turn: Turn
                       ,Won: Won
                       ,MustMove: MustMove
                       ,FromMove: FromMove
                       ,MustJump: MustJump
                       ,FromJump: FromJump
                       ,Own: Own
                       ,Enemy: Enemy
                       ,Peasant: Peasant
                       ,General: General};
   return _elm.Types.values;
};</script></head><body><script type="text/javascript">Elm.fullscreen(Elm.Board)</script><noscript></noscript></body></html>